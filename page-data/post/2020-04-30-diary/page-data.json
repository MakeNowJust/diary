{"componentChunkName":"component---src-templates-post-js","path":"/post/2020-04-30-diary/","result":{"data":{"site":{"siteMetadata":{"title":"℘ make now just"}},"markdownRemark":{"html":"<h1>やったこと</h1>\n<h2>diary</h2>\n<p><code>unicorn/no-null</code>というルールのせいで<code>eslint-plugin-unicorn</code>がアップデートできていなかったので、これを無効にしてマージした。<br>\nこの手のルールはフレームワークと使うのに相性が悪すぎるので仕方ない。</p>\n<h2>シャニ</h2>\n<p>Pカップが終わった。<br>\n世界に平和がもたらされる‥‥。</p>\n<p>SSR2倍はヤバイですね☆</p>\n<p><a href=\"https://twitter.com/make_now_just/status/1255829968442978305\" class=\"embedly-card\">https://twitter.com/make_now_just/status/1255829968442978305</a></p>\n<h2>Crystal</h2>\n<p>Crystalの型まわりのパーサを書き直した。</p>\n<p><a href=\"https://github.com/crystal-lang/crystal/pull/9208\" class=\"embedly-card\">https://github.com/crystal-lang/crystal/pull/9208</a></p>\n<p>これは前々からやりたいと思っていたことで、この修正でかなりのバグが直ったのではないかと思う。<br>\n問題点は、完全に書き直す必要性を理解できる人がどれだけいるか、ということ。</p>\n<p>現在のCrystalの型部分のパーサは大体、コンマ区切りで型を読んでいって、<code>-></code>に遭遇したらProc型に切り替える、みたいな挙動になっている。<br>\nこれだけならまだ単純なのだけど、<code>(A, B) -> C</code>みたいなパターンに対応するために、これまでに読んだ型を配列で持って、括弧に遭遇したらその配列を渡して再帰的に呼び出している。<br>\nついでに、タプルとかジェネリック型の型引数の場合も横着して(100%横着だと思う)この仕組みを使っているので、様々なところでおかしくなっている。</p>\n<p>はっきり言って既存のコードが動いているように見えるのは奇跡なので、全面的に書き直さないといけなかった。<br>\nというか、そうじゃなくても配列を持ち回してパースするとか筋が悪すぎるので、そうじゃない方法にすべき。</p>\n<p>どうやら今月はcrystal-lang/crystalに15個Pull Requestを出したらしい。<br>\nうち11個マージされてるからまあがんばったほう、だと思う。</p>\n<p>これ放置してるのどうにかしたいな。</p>\n<p><a href=\"https://github.com/crystal-lang/crystal/pull/8987\" class=\"embedly-card\">https://github.com/crystal-lang/crystal/pull/8987</a></p>\n<p>というか後半はフォーマッタとパーサしか直してないし性格だなぁ、という感じがする。</p>","fields":{"date":"2020-04-30"},"frontmatter":{"title":"Crystalの型まわりのパーサを書き直した"},"excerpt":"やったこと diary unicorn/no-nullというルールのせいでeslint-plugin-unicornがアップデートできていなかったので、これを無効にしてマージした。 この手のルールはフレームワークと使うのに相性が悪すぎるので仕方ない。 シャニ Pカップが終わった…"},"prev":null,"next":{"fields":{"date":"2020-04-29","slug":"/post/2020-04-29-diary/"},"frontmatter":{"title":"シャニやったり"}}},"pageContext":{"slug":"/post/2020-04-30-diary/","prevSlug":null,"nextSlug":"/post/2020-04-29-diary/"}}}