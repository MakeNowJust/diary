{"componentChunkName":"component---src-templates-post-js","path":"/post/2018-12-31-diary/","webpackCompilationHash":"7cd02b1dd5bc1f2e4364","result":{"data":{"site":{"siteMetadata":{"title":"℘ make now just"}},"markdownRemark":{"html":"<h1>やったこと</h1>\n<h2>diaryに芝を実装した</h2>\n<p>この上にGitHubの芝的なものが表示されるようになっているはず。</p>\n<p>ちなみに芝の漉さはテキストの分量で決まる。大きな記事ほど色が濃くなる、はず。<br>\n漉さは4段階あって、計算式は、</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-built_in\">Math</span>.min(<span class=\"hljs-built_in\">Math</span>.max(<span class=\"hljs-number\">7</span>, <span class=\"hljs-built_in\">Math</span>.floor(<span class=\"hljs-built_in\">Math</span>.log2(size))), <span class=\"hljs-number\">10</span>) - <span class=\"hljs-number\">7</span></code></pre>\n<p>になっている。1024文字以上書けば一番濃い色になるらしい。なんだ余裕だな、と思ったけど実際見てみると結構薄い。難しいものだ。<br>\nまた、テキストの長さというのはMarkdownのファイルサイズそのものじゃなくて、Markdownの記号を削ったものになっている。それが余計に濃くするのを難しくしている。</p>\n<p>ともかく、2018年が終わる前にdiaryをもう一段階アップデートできて良かったと思う。</p>\n<h2>CrystalにPull Requestを出したりした</h2>\n<ol>\n<li>\n<p><a href=\"https://github.com/crystal-lang/crystal/pull/7240\" class=\"embedly-card\">https://github.com/crystal-lang/crystal/pull/7240</a></p>\n<p>呼ばれたので直した。ぶっちゃけこれを直すくらいならば難しくはない。</p>\n<p>ややこしいのは、現状だと、</p>\n<pre><code class=\"hljs language-crystal\">foo(&#x26;.foo\n)</code></pre>\n<p>が、</p>\n<pre><code class=\"hljs language-crystal\">foo(&#x26;.foo)</code></pre>\n<p>にフォーマットされてくれないところ。これは普通の引数でも同じなんだけど、さらにややこしいことに、</p>\n<pre><code class=\"hljs language-crystal\">foo(<span class=\"hljs-number\">1</span>\n)</code></pre>\n<p>は、フォーマットしてもそのままなのに、</p>\n<pre><code class=\"hljs language-crystal\">foo(<span class=\"hljs-number\">1</span>,\n)</code></pre>\n<p>はフォーマットすると、</p>\n<pre><code class=\"hljs language-crystal\">foo(<span class=\"hljs-number\">1</span>)</code></pre>\n<p>になる。つまり、末尾のコンマの有無で結果が変わっている。が、<code>&#x26;.foo</code>のあとに<code>,</code>を置くことはできないので(これも謎の制限)この回避策が使えない。</p>\n<p>タイミングを見て直していきたい。</p>\n</li>\n<li>\n<p><a href=\"https://github.com/crystal-lang/crystal/pull/7241\" class=\"embedly-card\">https://github.com/crystal-lang/crystal/pull/7241</a></p>\n<p><code>crystal tool format foo.cr</code>とかしたときに出たエラーメッセージが<code>crystal tool format foo.cr</code>を実行しろというやつなんだけど、それをやっても当然同じエラーメッセージになってスタックトレースとか出ないので<code>crystal tool format - &#x3C; foo.cr</code>を表示するように修正した。<br>\n多分問題ないと思う。</p>\n<p>1引数の場合の特殊パターンが消えた時点で気付くべきだった。</p>\n</li>\n</ol>\n<p><code>spec</code>のやつ確認しようと思っているのだけどやる気が出ない‥‥。</p>\n<h2>スマブラ</h2>\n<p>年内に全キャラ集められたので有能。がんばったと思う。</p>\n<h2>2018年</h2>\n<p>終わる。今年を総括した記事を書きたかったけど普通に間に合わなかった。</p>","fields":{"date":"2018-12-31"},"frontmatter":{"title":"2018年最後の日です"},"excerpt":"やったこと diaryに芝を実装した この上にGitHubの芝的なものが表示されるようになっているはず。 ちなみに芝の漉さはテキストの分量で決まる。大きな記事ほど色が濃くなる、はず。 漉さは4段階あって、計算式は、 になっている。1024文字以上書けば一番濃い色になるらしい。な…"},"prev":{"fields":{"date":"2019-01-01","slug":"/post/2019-01-01-a-happy-new-year/"},"frontmatter":{"title":"あけおめ"}},"next":{"fields":{"date":"2018-12-30","slug":"/post/2018-12-30-diary/"},"frontmatter":{"title":"力尽きてた"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post/2018-12-31-diary/","prevSlug":"/post/2019-01-01-a-happy-new-year/","nextSlug":"/post/2018-12-30-diary/"}}}