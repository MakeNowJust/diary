{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/post/2020-08-31-diary/",
    "result": {"data":{"site":{"siteMetadata":{"title":"℘ make now just"}},"markdownRemark":{"html":"<h1>やったこと</h1>\n<h2>ジャンク</h2>\n<p>ジャンクガレッジに行ってきた。<br>\n夏の終わりなので。</p>\n<h2>Scala</h2>\n<p>Hedgehogの自前実装をひたすらやっていた。</p>\n<p>どうして<code>Tree</code>を返したいのか、という気持ちは結構分かった。</p>\n<ul>\n<li><code>shrink</code>の型は<code>T => Seq[T]</code>で、これと組にしてしまうと<code>Functor</code>にすることも難しい\n<ul>\n<li>引数に<code>T</code>が現れるため</li>\n<li><code>Invariant</code>にすることはできるが‥‥</li>\n</ul>\n</li>\n<li>ただ、<code>shrink</code>も同時に管理しないと、<code>filter</code>などで生成されるオブジェクトを正弦したときに、<code>shrink</code>でその制約を外れる値になってしまう可能性がある。</li>\n<li>↑なのでどうにかして<code>shrink</code>を合成したい</li>\n<li><code>shrink</code>関数を使って実際に縮小する過程を考えると<code>Tree</code>になるので、<code>Tree</code>を返すようにするのは妥当</li>\n</ul>\n<p>が、Hedgehogの実装を単純に再実装すると気になる部分もあったので、そこは直していってる。</p>\n<ul>\n<li><code>Gen</code>の型が<code>(Random, Int) => Tree[(Random, Option[T])]</code>だけど、本来乱数が絡まないはずの<code>Tree</code>の子要素まで<code>Random</code>を持っているのが気になる\n<ul>\n<li><code>StateT[Random, Tree, *]</code>と考えると妥当な合成ではある</li>\n<li>が、そこまでして<code>Monad</code>にする必要があるのかあやしい</li>\n<li>実際、2つの<code>Gen</code>を組にできる処理があれば大体問題ない</li>\n</ul>\n</li>\n<li>というわけで<code>(Random, Int) => (Random, Tree[Option[T]])</code>に変更した\n<ul>\n<li>おそらく<code>Monad</code>ではないので<code>flatMap</code>は定義されていない</li>\n<li>これは<code>ReaderT[Int, Nested[State[Random, *], Nested[Tree, Option, *]], *]</code>に同型</li>\n<li>なので、<code>Functor, Applicative</code>として合法(ついでに<code>FunctorFilter</code>も)</li>\n</ul>\n</li>\n<li><code>Gen.frequency</code>とかは明らかに壊れているので修正</li>\n</ul>\n<p>と、こんな感じ。</p>\n<p>Hedgehogの(表面的な)再実装は大体できたので、今は<code>Cogen</code>とかを実装して関数も生成できるようにしている。<br>\nこれ地味にだが‥‥。</p>","fields":{"date":"2020-08-31"},"frontmatter":{"title":"Hedgehogなんも分からん"},"excerpt":"やったこと ジャンク ジャンクガレッジに行ってきた。 夏の終わりなので。 Scala Hedgehogの自前実装をひたすらやっていた。 どうしてTreeを返したいのか、という気持ちは結構分かった。 shrinkの型はT => Seq[T]で、これと組にしてしまうとFunctor…"},"prev":{"fields":{"date":"2020-09-01","slug":"/post/2020-09-01-diary/"},"frontmatter":{"title":"シャニの配信だった"}},"next":{"fields":{"date":"2020-08-30","slug":"/post/2020-08-30-diary/"},"frontmatter":{"title":"Mステ3周年"}}},"pageContext":{"slug":"/post/2020-08-31-diary/","prevSlug":"/post/2020-09-01-diary/","nextSlug":"/post/2020-08-30-diary/"}},
    "staticQueryHashes": ["530032413"]}