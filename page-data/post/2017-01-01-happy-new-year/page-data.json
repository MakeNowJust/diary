{"componentChunkName":"component---src-templates-post-js","path":"/post/2017-01-01-happy-new-year/","webpackCompilationHash":"b4430a77a76a85070d02","result":{"data":{"site":{"siteMetadata":{"title":"℘ make now just"}},"markdownRemark":{"html":"<script async src=\"//cdn.embedly.com/widgets/platform.js\"></script>\n<p>あけましておめでとうございます。今年もよろしくお願いします。</p>\n<h1>やったこと</h1>\n<p>普通にCrystalにPull Request出してた。</p>\n<h2><code>Iterator#with_index(&#x26;block)</code>がメモリを確保しないようにした</h2>\n<p><a class=\"embedly-card\" href=\"https://github.com/crystal-lang/crystal/pull/3814\">Avoid allocation in Iterator#with_index(&#x26;block) by MakeNowJust · Pull Request #3814 · crystal-lang/crystal</a></p>\n<p>なんか手元のCrystalのリポジトリ見たらあったのでPull Requestを送っておいた。いつやったんだっけ？　大分前から問題としては認識してたんだけど、なんとなく放置してた気がする。</p>\n<p>というかどうしてこのコードがマージされていたのかが謎。<code>class</code>を<code>new</code>してるんだから止めろよ。</p>\n<h2><code>each</code>とか<code>each</code>っぽいメソッドはレシーバーを返すようにした</h2>\n<p><a class=\"embedly-card\" href=\"https://github.com/crystal-lang/crystal/pull/3815\">Fix each* methods to return self by MakeNowJust · Pull Request #3815 · crystal-lang/crystal</a></p>\n<p>地味に面倒だった。<code>grep</code>かけてチェックしていくだけだけど。テストが雑な気がする。</p>\n<p>ちなみに<code>Enumerable#each_cons</code>とかは<code>nil</code>を返すまま変更してない。というのもRubyがそうだったから。でもどうしてそうなってるんだろう？　別にレシーバー返してもよくない？</p>\n<h1>やること</h1>\n<p>今年の抱負的なことは明日書きます。あとパーフェクト・ブルー観たい。</p>","fields":{"date":"2017-01-01"},"frontmatter":{"title":"あけましておめでとうございます"},"excerpt":"あけましておめでとうございます。今年もよろしくお願いします。 やったこと 普通にCrystalにPull Request出してた。 Iterator#with_index(&block)がメモリを確保しないようにした Avoid allocation in Iterator#w…"},"prev":{"fields":{"date":"2017-01-02","slug":"/post/2017-01-02-hash-compact-sora-no-method/"},"frontmatter":{"title":"Hash#compactを実装したり、天体のメソッドのspecを書いたり"}},"next":{"fields":{"date":"2016-12-31","slug":"/post/2016-12-31-c91-third-day/"},"frontmatter":{"title":"C91の3日目に参戦してきた"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post/2017-01-01-happy-new-year/","prevSlug":"/post/2017-01-02-hash-compact-sora-no-method/","nextSlug":"/post/2016-12-31-c91-third-day/"}}}