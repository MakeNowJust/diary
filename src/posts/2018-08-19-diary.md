---
title: ペンギン・ハイウェイを観に行った
---

# やったこと

## ペンギン・ハイウェイを観に行った

暁丸と観に行った。

よくできた映画だと思う。ただ、それでいて面白かったので、そういう意味でとてもよくできた映画だったのだと思う。
前半に起こった出来事を後半で残さず拾っていっていて、それでいてしっかりとラストを作っているので、見終わったあとの感覚がとても良かった。

面白い映画で良かったな、と思う。

ペンギン・ハイウェイを観たあとは二郎に行ってムーンウォークに行った。暁丸といると大体そういうムーブになるっぽい。

## 色々直した

Crystalしんどい。

https://github.com/crystal-lang/crystal/pull/6568

かなりしんどかった。

`"#{"foo"}"`みたいなのがエラーになるのだけど、これをAryはパーサーが文字列補間の情報を保持しないから(この例の場合単一の`"foo"`と同じASTが返る)と予想していたのだけど、実際はフォーマッターがそういう場合をそもそも想定していなかったというのが正しい。
この辺はややこしいのでフォーマッターを延々と弄ってる人にしか伝わらない気がするが‥‥。

ちなみに今のままだとheredocは対応できてなかったりする。おいおい。直すためには二つのことが必要な気がしている。一つは`StringLiteral`を期待するところで`#{`が来た場合に`delimiter_state`を保存するようにすることで、もう一つは`has_interpolation`が`false`の場合のために`StringLiteral`でもheredocをフォーマットできるようにすること。多分この二つでいける。

https://github.com/crystal-lang/crystal/pull/6567

こっちはとくに何も考えてない。タイポした。あほか。
